<script>
var options = {
	template: '../lib/pair/imitate.html',
	id: 'generic_imitate',
	title: 'deviceClasses.generic_remote.views.generic_imitate.title',
	body: 'deviceClasses.generic_remote.views.generic_imitate.body',
	svg: '<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<!-- Creator: CorelDRAW X7 -->\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:pulse="pulse" xmlns:show="show" xmlns:hide="hide" xml:space="preserve" width="650px" height="1415px" version="1.1" style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"\nviewBox="0 0 650 1415"\n xmlns:xlink="http://www.w3.org/1999/xlink">\n <defs>\n  <style type="text/css">\n   <![CDATA[\n    .stroke {stroke:#2B2A29;stroke-width:2.3622}\n    .fill1 {fill:#707070}\n    .fill0 {fill:#2B2A29;fill-rule:nonzero}\n    .fillw {fill:#FFFFFF}\n   ]]>\n  </style>\n </defs>\n <g id="Layer_x0020_1">\n  <path class="fill0" d="M22 1147c10,71 49,134 103,180 55,47 125,76 198,76l0 0c79,1 158,-30 218,-82 56,-49 94,-117 97,-194 0,-1 0,-11 -1,-29 -1,-75 -5,-275 -5,-417 0,-89 1,-163 3,-236 2,-71 3,-140 3,-224 0,-45 -11,-97 -53,-138 -42,-41 -116,-71 -242,-71l0 0c-11,0 -15,0 -25,0l-5 0 0 0c-108,4 -179,26 -225,57 -59,39 -76,94 -76,144 0,83 3,155 7,228 4,75 8,151 8,240 0,142 -4,342 -6,417 0,18 0,28 0,29 0,2 0,7 0,12 1,4 1,7 1,7l0 1zm95 189c-56,-48 -96,-114 -107,-188 0,-1 0,-4 0,-8 -1,-5 -1,-11 -1,-13 0,-1 0,-11 0,-30 2,-73 6,-272 6,-416 0,-90 -4,-165 -8,-240 -3,-73 -7,-145 -7,-228 0,-54 19,-112 82,-154 47,-32 120,-55 231,-59l0 0 5 0c10,0 14,0 25,0l0 0c129,0 206,32 250,75 45,43 57,99 57,146 0,82 -2,153 -3,224 -2,72 -4,145 -4,236 0,144 4,343 6,416 0,19 0,29 0,30 -2,81 -42,151 -101,203 -61,54 -143,86 -225,84l0 1c-75,0 -149,-30 -206,-79z" id="path10" />\n  <path class="fill1 stroke" d="M326 127c16,0 29,13 29,29 0,16 -13,29 -29,29 -16,0 -29,-13 -29,-29 0,-16 13,-29 29,-29z" id="path12" />\n  <path class="fill1 stroke" d="m 324,1187 c -125,-3 -216,-80 -230,-179 0,-2 -1,-12 -1,-14 0,-3 8,-184 8,-306 0,-121 -4,-190 -5,-306 -3,-59 44,-163 230,-163 186,0 231,104 228,163 -1,116 -5,185 -5,306 0,122 8,303 8,306 0,2 -1,12 -1,14 -14,99 -107,177 -232,179 z" id="path3434" />\n  <path d="m 331,390 -4,0 0,-26 c -1,1 -2,2 -4,3 -1,1 -3,2 -4,2 l 0,-4 c 2,-1 4,-2 6,-4 2,-1 3,-3 4,-4 l 2,0 0,33 z" id="path3432" />\n  <path d="m 336,517 0,4 -22,0 c 0,-1 0,-2 1,-3 0,-2 1,-3 2,-4 2,-2 3,-4 6,-5 3,-3 6,-6 7,-7 1,-2 2,-4 2,-5 0,-2 -1,-3 -2,-4 -1,-2 -3,-2 -4,-2 -2,0 -4,0 -5,2 -1,1 -2,2 -2,5 l -4,-1 c 0,-3 1,-5 3,-7 2,-2 5,-2 8,-2 3,0 5,0 7,2 2,2 3,4 3,7 0,1 0,2 -1,4 0,1 -1,2 -2,4 -2,1 -4,3 -7,5 -2,3 -4,4 -4,5 -1,0 -2,1 -2,2 l 16,0 z" id="path3430" />\n  <path d="m 314,643 4,-1 c 1,2 2,4 3,5 1,1 2,2 4,2 2,0 3,-1 5,-2 1,-2 2,-3 2,-5 0,-2 -1,-4 -2,-5 -1,-1 -3,-2 -5,-2 -1,0 -2,0 -3,1 l 1,-4 c 0,0 0,0 0,0 2,0 4,0 5,-1 1,-1 2,-3 2,-4 0,-2 0,-3 -1,-4 -1,-1 -3,-2 -4,-2 -2,0 -3,1 -4,2 -1,1 -2,2 -2,4 l -4,0 c 0,-3 1,-5 3,-7 2,-1 4,-2 7,-2 1,0 3,1 5,1 1,1 2,2 3,3 1,2 1,3 1,5 0,1 0,2 -1,4 -1,1 -2,2 -3,2 2,1 3,2 4,3 1,2 2,3 2,6 0,2 -1,5 -3,7 -2,2 -5,3 -8,3 -3,0 -6,-1 -7,-3 -2,-1 -3,-4 -4,-6 z" id="path3428" />\n  <path d="m 328,781 0,-8 -14,0 0,-3 15,-22 3,0 0,22 5,0 0,3 -5,0 0,8 -4,0 z" id="path3426" />\n  <path class="fill1" d="m 328,770 0,-15 -10,15 10,0 z" id="path3424" />\n  <path d="m 294,901 10,-25 4,0 10,25 -4,0 -3,-7 -10,0 -3,7 -4,0 z" id="path3422" />\n  <path class="fill1" d="m 302,891 8,0 -2,-7 c -1,-2 -2,-4 -2,-5 -1,1 -1,3 -2,4 l -2,8 z" id="path3420" />\n  <path d="m 320,901 0,-25 4,0 0,22 12,0 0,3 -16,0 z" id="path3418" />\n  <path d="m 340,901 0,-25 3,0 0,22 13,0 0,3 -16,0 z" id="path3416" />\n  <path id="path3380" d="m 430,1079 0,-38 5,0 0,33 18,0 0,5 -23,0 z m -46,-19 c 0,-2 0,-5 1,-7 1,-3 3,-5 4,-6 2,-2 5,-4 7,-5 2,-1 5,-1 8,-1 2,0 5,0 7,1 3,1 5,3 7,5 2,1 3,4 4,6 1,2 2,5 2,7 0,3 -1,5 -2,8 -1,2 -2,4 -4,6 -2,2 -4,3 -7,4 -2,1 -5,2 -7,2 -3,0 -6,-1 -8,-2 -3,-1 -5,-2 -7,-4 -1,-2 -3,-4 -4,-6 -1,-3 -1,-5 -1,-8 z m -29,19 0,-38 11,0 c 3,0 6,1 8,3 2,2 3,4 3,8 0,2 0,4 -1,6 -1,1 -3,2 -6,3 1,0 2,1 2,1 1,1 1,2 2,3 l 9,14 -6,0 -7,-10 c -1,-3 -3,-5 -4,-6 -1,0 -3,-1 -4,-1 l -2,0 0,17 -5,0 z m -24,0 0,-33 -14,0 0,-5 33,0 0,5 -14,0 0,33 -5,0 z m -53,0 0,-38 5,0 25,30 0,-30 5,0 0,38 -5,0 -24,-29 0,29 -6,0 z m -46,-19 c 0,-2 1,-5 2,-7 1,-3 2,-5 4,-6 2,-2 4,-4 7,-5 2,-1 5,-1 7,-1 3,0 6,0 8,1 2,1 5,3 6,5 2,1 4,4 5,6 1,2 1,5 1,7 0,3 0,5 -1,8 -1,2 -3,4 -4,6 -2,2 -5,3 -7,4 -2,1 -5,2 -8,2 -2,0 -5,-1 -7,-2 -3,-1 -5,-2 -7,-4 -2,-2 -3,-4 -4,-6 -1,-3 -2,-5 -2,-8 z m -4,10 0,6 c -2,1 -4,2 -7,3 -2,0 -4,1 -6,1 -2,0 -4,-1 -6,-1 -2,-1 -4,-2 -6,-3 -3,-2 -5,-4 -6,-7 -2,-3 -3,-6 -3,-9 0,-2 1,-5 2,-7 1,-3 2,-5 4,-6 2,-2 4,-4 7,-5 2,-1 5,-1 8,-1 2,0 4,0 6,1 2,0 5,1 7,2 l 0,6 c -2,-2 -5,-3 -7,-3 -2,-1 -4,-1 -6,-1 -4,0 -8,1 -11,4 -3,3 -4,6 -4,10 0,4 1,8 4,10 3,3 7,5 11,5 2,0 4,-1 6,-2 3,0 5,-1 7,-3 z m 175,-57 0,-37 23,0 0,5 -17,0 0,11 16,0 0,5 -16,0 0,12 17,0 0,4 -23,0 z m -23,0 0,-32 -14,0 0,-5 33,0 0,5 -14,0 0,32 -5,0 z m -56,-18 c 0,-3 0,-5 1,-8 1,-2 3,-4 4,-6 2,-2 5,-3 7,-4 2,-1 5,-2 8,-2 2,0 5,1 7,2 3,1 5,2 7,4 2,2 3,4 4,6 1,3 2,5 2,8 0,2 -1,5 -2,7 -1,3 -2,5 -4,6 -2,2 -4,4 -7,5 -2,1 -5,1 -7,1 -3,0 -6,0 -8,-1 -3,-1 -5,-3 -7,-5 -1,-1 -3,-3 -4,-6 -1,-2 -1,-5 -1,-7 z m -43,18 0,-37 5,0 13,16 14,-16 5,0 0,37 -6,0 0,-29 -13,15 -12,-15 0,29 -6,0 z m -30,0 0,-37 23,0 0,5 -17,0 0,11 17,0 0,5 -17,0 0,12 18,0 0,4 -24,0 z m -31,0 0,-37 11,0 c 4,0 7,1 9,3 2,1 3,4 3,7 0,3 0,5 -1,6 -2,2 -3.17157,2.58579 -6,4 -0.89443,0.44721 1,0 2,1 1,1 1,1 2,3 l 9,13 -6,0 -7,-9 c -2,-3 -3,-5 -4,-6 -2,-1 -3,-1 -5,-1 l -1,0 0,16 z" />\n  <path class="fill1" d="m 226,992 4,0 c 3,0 5,0 6,-1 1,-1 2,-3 2,-5 0,-2 -1,-3 -2,-4 -1,-1 -3,-1 -6,-1 l -4,0 0,11 z" id="path3412" />\n  <path class="fill1" d="m 329,995 c 0,2 1,4 1,5 1,2 2,4 3,5 2,1 3,2 5,3 2,1 4,1 6,1 2,0 3,0 5,-1 2,-1 3,-2 5,-3 1,-1 2,-3 3,-5 1,-1 1,-3 1,-5 0,-2 0,-4 -1,-6 -1,-1 -2,-3 -3,-4 -2,-2 -3,-3 -5,-3 -2,-1 -3,-2 -5,-2 -2,0 -4,1 -6,2 -2,0 -3,1 -5,3 -1,1 -2,3 -3,4 0,2 -1,4 -1,6 z" id="path3406" />\n  <path class="fill1" d="m 238,1060 c 0,2 0,4 1,6 1,1 2,3 3,4 1,2 3,3 5,3 2,1 3,2 5,2 2,0 4,-1 6,-2 2,0 3,-1 4,-3 2,-1 3,-3 4,-4 0,-2 1,-4 1,-6 0,-2 -1,-3 -1,-5 -1,-2 -2,-3 -4,-5 -1,-1 -2,-2 -4,-3 -2,-1 -4,-1 -6,-1 -2,0 -3,0 -5,1 -2,1 -3,2 -5,3 -1,1 -2,3 -3,5 -1,1 -1,3 -1,5 z" id="path3396" />\n  <path class="fill1" d="m 360,1058 4,0 c 3,0 5,-1 6,-2 1,-1 2,-2 2,-4 0,-2 -1,-4 -2,-5 -1,-1 -3,-1 -6,-1 l -4,0 0,12 z" id="path3386" />\n  <path class="fill1" d="m 389,1060 c 0,2 1,4 1,6 1,1 2,3 3,4 2,2 3,3 5,3 2,1 4,2 6,2 1,0 3,-1 5,-2 2,0 3,-1 5,-3 1,-1 2,-3 3,-4 1,-2 1,-4 1,-6 0,-2 0,-3 -1,-5 -1,-2 -2,-3 -3,-5 -2,-1 -3,-2 -5,-3 -2,-1 -4,-1 -5,-1 -2,0 -4,0 -6,1 -2,1 -3,2 -5,3 -1,1 -2,3 -3,5 0,1 -1,3 -1,5 z" id="path3384" />\n  <path d="m 176,314 c 0,-5 1,-9 4,-11 3,-3 6,-5 10,-5 3,0 6,1 8,2 2,2 4,3 5,6 1,2 2,5 2,8 0,3 -1,6 -2,8 -1,3 -3,4 -5,6 -3,1 -5,2 -8,2 -2,0 -5,-1 -7,-3 -3,-1 -4,-3 -5,-5 -2,-3 -2,-5 -2,-8 z" id="path3378" />\n  <path class="fill1" d="m 180,314 c 0,4 1,7 3,9 2,2 4,3 7,3 3,0 6,-1 8,-3 2,-2 3,-5 3,-9 0,-3 -1,-5 -2,-6 0,-2 -2,-4 -3,-5 -2,-1 -4,-1 -6,-1 -2,0 -5,1 -7,3 -2,2 -3,5 -3,9 z" id="path3376" />\n  <path d="m 210,329 0,-30 4,0 16,24 0,-24 4,0 0,30 -4,0 -16,-24 0,24 -4,0 z" id="path3374" />\n  <path d="m 405,314 c 0,-5 2,-9 4,-11 3,-3 7,-5 11,-5 3,0 5,1 7,2 3,2 4,3 6,6 1,2 1,5 1,8 0,3 0,6 -2,8 -1,3 -3,4 -5,6 -2,1 -5,2 -7,2 -3,0 -6,-1 -8,-3 -2,-1 -4,-3 -5,-5 -1,-3 -2,-5 -2,-8 z" id="path3372" />\n  <path class="fill1" d="m 410,314 c 0,4 0,7 2,9 2,2 5,3 8,3 3,0 5,-1 7,-3 2,-2 3,-5 3,-9 0,-3 0,-5 -1,-6 -1,-2 -2,-4 -4,-5 -1,-1 -3,-1 -5,-1 -3,0 -5,1 -7,3 -2,2 -3,5 -3,9 z" id="path3370" />\n  <path d="m 440,329 0,-30 20,0 0,3 -16,0 0,10 14,0 0,3 -14,0 0,14 -4,0 z" id="path3368" />\n  <path d="m 465,329 0,-30 21,0 0,3 -17,0 0,10 15,0 0,3 -15,0 0,14 -4,0 z" id="path3366" />\n  <path pulse:initial="true" pulse:unit="111" pulse:state="1" class="fillw" d="m 167,347 -4,0 c -17,1 -32,16 -32,34 0,18 15,33 34,34 l 1,0 78,0 c 0,0 0,0 0,0 0,0 0,0 0,0 19,0 34,-16 34,-34 0,-19 -15,-34 -34,-34 0,0 -1,0 -2,0 l -75,0 z" id="path3364" />\n  <path pulse:unit="110" pulse:state="1" class="fillw" d="m 167,477 -4,0 c -17,1 -32,16 -32,34 0,18 15,33 34,34 l 1,0 78,0 c 0,0 0,0 0,0 0,0 0,0 0,0 19,0 34,-16 34,-34 0,-19 -15,-34 -34,-34 0,0 -1,0 -2,0 l -75,0 z" id="path3362" />\n  <path pulse:unit="101" pulse:state="1" class="fillw" d="m 167,605 -4,0 c -17,1 -32,15 -32,33 0,19 15,34 34,34 l 1,0 78,0 c 0,0 0,0 0,0 0,0 0,0 0,0 19,0 34,-15 34,-34 0,-18 -15,-34 -34,-34 0,0 -1,0 -2,1 l -75,0 z" id="path3360" />\n  <path pulse:unit="011" pulse:state="1" class="fillw" d="m 170,733 -4,0 c -18,1 -32,15 -32,33 0,18 15,33 33,34 l 1,0 77,0 c 0,0 0,0 0,0 0,0 1,0 1,0 18,0 33,-15 33,-34 0,-18 -15,-33 -34,-33 0,0 -1,0 -2,0 l -73,0 z" id="path3358" />\n  <path pulse:unit="000" pulse:state="1" class="fillw" d="m 170,859 -4,0 c -18,1 -32,15 -32,33 0,18 15,33 33,34 l 1,0 77,0 c 0,0 0,0 0,0 0,0 1,0 1,0 18,0 33,-15 33,-34 0,-18 -15,-33 -34,-33 0,0 -1,0 -2,0 l -73,0 z" id="path3356" />\n  <path pulse:unit="111" pulse:state="0" class="fillw" d="m 483,347 4,0 c 17,1 32,16 32,34 0,18 -15,33 -34,34 l -1,0 -78,0 c 0,0 0,0 0,0 0,0 0,0 0,0 -19,0 -34,-16 -34,-34 0,-19 15,-34 34,-34 0,0 1,0 2,0 l 75,0 z" id="path3354" />\n  <path pulse:unit="110" pulse:state="0" class="fillw" d="m 483,477 4,0 c 17,1 32,16 32,34 0,18 -15,33 -34,34 l -1,0 -78,0 c 0,0 0,0 0,0 0,0 0,0 0,0 -19,0 -34,-16 -34,-34 0,-19 15,-34 34,-34 0,0 1,0 2,0 l 75,0 z" id="path3352" />\n  <path pulse:unit="101" pulse:state="0" class="fillw" d="m 483,605 4,0 c 17,1 32,15 32,33 0,19 -15,34 -34,34 l -1,0 -78,0 c 0,0 0,0 0,0 0,0 0,0 0,0 -19,0 -34,-15 -34,-34 0,-18 15,-34 34,-34 0,0 1,0 2,1 l 75,0 z" id="path3350" />\n  <path pulse:unit="011" pulse:state="0" class="fillw" d="m 480,733 4,0 c 18,1 32,15 32,33 0,18 -15,33 -33,34 l -1,0 -77,0 c 0,0 0,0 0,0 0,0 0,0 -1,0 -18,0 -33,-15 -33,-34 0,-18 15,-33 34,-33 0,0 1,0 2,0 l 73,0 z" id="path3348" />\n  <path pulse:unit="000" pulse:state="0" class="fillw" d="m 480,859 4,0 c 18,1 32,15 32,33 0,18 -15,33 -33,34 l -1,0 -77,0 c 0,0 0,0 0,0 0,0 0,0 -1,0 -18,0 -33,-15 -33,-34 0,-18 15,-33 34,-33 0,0 1,0 2,0 l 73,0 z" id="path14" />\n </g>\n</svg>\n',
	svgWidth: '80vw',
	svgHeight: '70vh',
	initWithDeviceData: false,
	previous: true,
	next: false
};
Homey.setTitle(__(options.title || ''));
Homey.emit('init', options.id);
Homey.on('show_view', function(viewId){
	Homey.showView(viewId);
});
Homey.on('close', function(){
	Homey.close();
});
Homey.on('nextView', function(viewsIds){
	var viewIndex = viewsIds.indexOf(options.id) + 1;
	if(viewIndex > 0 && viewIndex < viewsIds.length){
		Homey.showView(viewsIds[viewIndex]);
	}
});
Homey.on('previousView', function(viewsIds){
	var viewIndex = viewsIds.indexOf(options.id) - 1;
	if(viewIndex >= 0){
		Homey.showView(viewsIds[viewIndex]);
	}
});
function nextView(){
	if(options.next){
		Homey.nextView();
	}else{
		Homey.emit('next');
	}
}
</script>

<link href="../../../assets/433_generator/css/styles.css" rel="stylesheet" type="text/css"/>

<link href="../../../assets/433_generator/css/svg.css" rel="stylesheet" type="text/css"/>

<script src="../../../assets/433_generator/js/svghighlighter.js" type="text/javascript"></script>

<div class="centered-container">
	<div id="image-container"></div>
	<div id="body"><span class="content"></span></div>
	<div class="foundAnimation" id="foundBackground" style="display:none;"></div>
	<i class="fa fa-check-circle foundAnimation" id="found" style="display:none;" aria-hidden="true"></i>
</div>

<script>
	var idPrefix = '[data-id="' + options.id + '"] ';
	$(idPrefix + '#body > span').html(__(options.body));
	var $imageContainer = $(idPrefix + '#image-container');
	$imageContainer.css('width', options.svgWidth).css('height', options.svgHeight);

	$imageContainer.html(options.svg);
	$imageContainer.highlight();

	var found = false;
	Homey.on('frame', function (data) {
		console.log('GOT FRAME', data);
		if(!found) {
			found = true;
			Homey.emit('set_device', data, function (err, device) {
				if (err) {
					if((err.message || err) !== '433_generator.error.invalid_device') {
						Homey.alert(err.message && err.message.indexOf(' ') === -1 && __(err.message) !== err.message ? __(err.message) : JSON.stringify(err));
					}
					found = false;
					return;
				}
				const dataKey = JSON.stringify(device.data);
				window.selected_devices = [ dataKey ];
				window.found_devices = {};
				window.found_devices[dataKey] = device;
				var $foundElems = $(idPrefix + '.foundAnimation');
				$foundElems.show();
				setTimeout(function () {
					$foundElems.addClass('fadeOut');
					setTimeout(nextView, 400);
				}, 500);
			});
		}
	});
</script>

<style>
	#found {
		z-index: 2;
		position: absolute;
		top: 20vh;
		left: 38vw;
		font-size: 30vh;
		color: #080;
		opacity: 1;
	}

	#foundBackground {
		z-index: 1;
		top: 0;
		bottom: 0;
		left: 0;
		right: 0;
		position: absolute;
		background-color: #FFF;
		opacity: 0.8;
	}

	.fadeOut {
		-webkit-transition: all 0.5s ease-in-out;
		-moz-transition: all 0.5s ease-in-out;
		-ms-transition: all 0.5s ease-in-out;
		-o-transition: all 0.5s ease-in-out;
		transition: all 0.5s ease-in-out;
		opacity: 0 !important;
	}
</style>